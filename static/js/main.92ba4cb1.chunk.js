(this.webpackJsonppagemail=this.webpackJsonppagemail||[]).push([[0],{51:function(e,t,a){},53:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),s=a.n(c),i=(a(51),a(8)),l=a.n(i),o=a(11),j=a(15),d=(a(53),a(45)),u=a(7),b=a(67),m=a(75),x=a(69),h=a(74),O=a(73),p=a(1);function g(e){return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(h.a,{bg:"primary",variant:"dark",children:[Object(p.jsx)(h.a.Brand,{href:"/",children:"PageMail"}),Object(p.jsx)(h.a.Toggle,{"aria-controls":"navbar-nav"}),Object(p.jsx)(h.a.Collapse,{id:"navbar-nav mr-auto",children:Object(p.jsx)(O.a,{className:"mr-auto",children:e.loggedIn?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(O.a.Link,{href:"#/pages",children:"Pages"}),Object(p.jsx)(O.a.Link,{href:"#/save",children:"Save a page"})]}):Object(p.jsx)(p.Fragment,{})})}),Object(p.jsx)(O.a,{children:e.loggedIn?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(O.a.Link,{href:"#/user",className:"mr-2",children:"Profile"})}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(O.a.Link,{href:"#/signup",children:"Sign up!"}),Object(p.jsx)(O.a.Link,{href:"#/login",children:"Log in"})," "]})})]})})}var f=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(b.a,{children:[Object(p.jsx)("h2",{className:"display-2",children:"Pagemail"}),Object(p.jsx)("p",{className:"lead",children:"We are a service for bookmarking websites you want to come back to later. Instead of losing pages in expensive read-it-later services or browser bookmarks, you can have them delivered to your inbox in a simple list to make it easy to pick up where you left off."}),Object(p.jsxs)("p",{className:"lead",children:["This site is still under construction, so please bear in mind that not everything will be working! If you find a bug, please ",Object(p.jsx)("a",{href:"mailto:elunnon.pagemail@gmail.com",children:"send us an email here"})," , or file an issue on ",Object(p.jsx)("a",{href:"https://github.com/mr55p-dev/PageMail-website",children:"GitHub"}),"."]})]})})},v=a(68),k=a(44),w=a(72),y=a(70);function C(e){var t=function(){var t=Object(o.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),(n=new URLSearchParams).append("username",a.target.form[0].value),n.append("password",a.target.form[1].value),t.next=6,e.loginCall("POST","/user/token",!1,n);case 6:(r=t.sent)&&(localStorage.setItem("login_token",r.access_token),e.loginStatus(!0),e.redirect("/pages"));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.a,{fluid:!0,children:Object(p.jsx)(v.a,{children:Object(p.jsx)(k.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(p.jsx)(b.a,{color:"primary",className:"form-container bg-active",children:Object(p.jsxs)(w.a,{id:"loginForm",onSubmit:t,children:[Object(p.jsxs)(w.a.Group,{controlId:"formBasicEmail",name:"signup_email",id:"signup_email",children:[Object(p.jsx)(w.a.Label,{children:"Email address"}),Object(p.jsx)(w.a.Control,{type:"email",placeholder:"Enter email"})]}),Object(p.jsxs)(w.a.Group,{controlId:"formBasicPassword",name:"signup_password",children:[Object(p.jsx)(w.a.Label,{children:"Password"}),Object(p.jsx)(w.a.Control,{type:"password",placeholder:"Password"})]}),Object(p.jsxs)(v.a,{children:[Object(p.jsx)(k.a,{sm:12,xl:6,children:Object(p.jsx)(x.a,{block:!0,variant:"secondary",type:"button",onClick:function(t){t.preventDefault(),e.prefillEmail(t.target.form[0].value),e.redirect("/signup")},children:"Sign Up"})}),Object(p.jsx)(k.a,{sm:12,xl:6,children:Object(p.jsx)(x.a,{block:!0,variant:"primary",type:"submit",onClick:t,disabled:e.loading,children:e.loading?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):"Log in"})})]})]})})})})})})}function S(e){var t=function(){var t=Object(o.a)(l.a.mark((function t(a){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),(n=new URLSearchParams).append("email",a.target[0].value),n.append("name",a.target[1].value),n.append("password",a.target[2].value),t.next=7,e.signupCall("POST","/user/register",!1,n);case 7:(r=t.sent)&&(localStorage.setItem("login_token",r.token.access_token),e.loginStatus(!0),e.redirect("/user"),e.success("Success - Check your inbox for a confirmation email!"));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.a,{fluid:!0,children:Object(p.jsx)(v.a,{children:Object(p.jsx)(k.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(p.jsx)(b.a,{color:"primary",className:"form-container bg-active",children:Object(p.jsxs)(w.a,{id:"signupForm",onSubmit:t,children:[Object(p.jsxs)(w.a.Group,{controlId:"formBasicEmail",name:"signup_email",id:"signup_email",children:[Object(p.jsx)(w.a.Label,{children:"Email address"}),Object(p.jsx)(w.a.Control,{type:"email",placeholder:"Enter email",defaultValue:e.prefillEmail})]}),Object(p.jsxs)(w.a.Group,{controlId:"formBasicName",name:"signup_name",children:[Object(p.jsx)(w.a.Label,{children:"Name"}),Object(p.jsx)(w.a.Control,{type:"text",placeholder:"Your name"})]}),Object(p.jsxs)(w.a.Group,{controlId:"formBasicPassword",name:"signup_password",children:[Object(p.jsx)(w.a.Label,{children:"Password"}),Object(p.jsx)(w.a.Control,{type:"password",placeholder:"Password"})]}),Object(p.jsxs)(v.a,{children:[Object(p.jsx)(k.a,{sm:12,xl:6,children:Object(p.jsx)(x.a,{block:!0,variant:"secondary",type:"button",onClick:function(){e.redirect("/login")},children:"Log in"})}),Object(p.jsxs)(k.a,{sm:12,xl:6,children:[Object(p.jsx)(x.a,{block:!0,variant:"primary",type:"submit",disabled:e.loading,children:e.loading?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):"Sign Up"}),"                    "]})]})]})})})})})})}var N=a(76),L=a(71);function F(e){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(x.a,{block:e.block,variant:"primary",disabled:e.loading,onClick:e.reloadCallback,children:e.loading?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):e.buttonText?e.buttonText:"Reload"})})}function P(e){return Object(p.jsx)(k.a,{xl:4,md:6,xs:12,className:"my-2",children:Object(p.jsxs)(N.a,{children:[Object(p.jsxs)(N.a.Body,{className:"flex-fill",children:[Object(p.jsx)(N.a.Title,{className:"text-center text-overflow",children:e.title?e.title:e.url}),Object(p.jsx)(N.a.Subtitle,{className:"text-center text-overflow",children:e.url}),Object(p.jsxs)(N.a.Text,{className:"text-overflow",children:[e.description,Object(p.jsxs)(v.a,{className:"my-auto",children:[Object(p.jsx)(k.a,{xl:6,sm:12,className:"mt-1",children:Object(p.jsx)(x.a,{block:!0,variant:"warning",disabled:!0,onClick:function(){},children:"Delete"})}),Object(p.jsx)(k.a,{xl:6,sm:12,className:"mt-1",children:Object(p.jsx)(x.a,{block:!0,variant:"primary",onClick:function(){return window.open(e.url)},children:"Open"})})]})]})]}),Object(p.jsx)(N.a.Footer,{children:Object(p.jsxs)("small",{children:["Added at ",e.date]})})]})})}function E(e){var t=e.pageCall,a=Object(n.useState)([]),r=Object(j.a)(a,2),c=r[0],s=r[1],i=Object(n.useCallback)((function(){(function(){var e=Object(o.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("GET","/page/mypages",!0,null);case 2:a=e.sent,s(a||[]),console.log(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);return Object(n.useEffect)((function(){i()}),[i]),Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(b.a,{fluid:!0,className:"cardDeckContainer mx-auto",children:[Object(p.jsx)(L.a,{children:c!==[]?c.map((function(e){return Object(p.jsx)(P,{title:e.title,url:e.url,date:e.date_added,description:e.description},e.id)})):null}),Object(p.jsx)(F,{loading:e.loading,reloadCallback:i})]})})}function I(e){var t=function(){var t=Object(o.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),(n=new URLSearchParams).append("url",a.target.form[0].value),t.next=5,e.saveCall("POST","/page/save",!0,n);case 5:t.sent&&e.success("Saved!");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.a,{fluid:!0,children:Object(p.jsx)(v.a,{children:Object(p.jsx)(k.a,{xl:3,md:4,xs:12,className:"mx-auto",children:Object(p.jsx)(b.a,{color:"primary",className:"form-container bg-active",children:Object(p.jsxs)(w.a,{id:"loginForm",onSubmit:t,children:[Object(p.jsxs)(w.a.Group,{controlId:"formBasicEmail",name:"signup_email",id:"signup_email",children:[Object(p.jsx)(w.a.Label,{children:"Page address"}),Object(p.jsx)(w.a.Control,{type:"text",defaultValue:"https://"})]}),Object(p.jsx)(v.a,{children:Object(p.jsx)(k.a,{children:Object(p.jsx)(x.a,{block:!0,variant:"primary",type:"submit",onClick:t,disabled:e.loading,children:e.loading?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(y.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}),"Loading"]}):"Submit"})})})]})})})})})})}function _(e){var t=e.profileCall,a=Object(n.useState)(null),r=Object(j.a)(a,2),c=r[0],s=r[1],i=Object(n.useCallback)((function(){(function(){var e=Object(o.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("GET","/user/self",!0,null);case 2:a=e.sent,s(a||null);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);return Object(n.useEffect)((function(){i()}),[i]),Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(b.a,{fluid:!0,children:Object(p.jsx)(v.a,{children:Object(p.jsx)(k.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(p.jsx)(b.a,{color:"primary",className:"form-container bg-active",children:Object(p.jsxs)(w.a,{id:"infoForm",children:[Object(p.jsxs)(w.a.Group,{as:v.a,controlId:"formBasicEmail",name:"infoName",id:"signup_email",children:[Object(p.jsx)(w.a.Label,{column:!0,sm:2,children:"Name"}),Object(p.jsx)(k.a,{sm:10,children:Object(p.jsx)(w.a.Control,{type:"text",readOnly:!0,defaultValue:c?c.name:""})})]}),Object(p.jsxs)(w.a.Group,{as:v.a,controlId:"formBasicEmail",name:"infoEmail",id:"signup_email",children:[Object(p.jsx)(w.a.Label,{column:!0,sm:2,children:"Email address"}),Object(p.jsx)(k.a,{sm:10,children:Object(p.jsx)(w.a.Control,{type:"email",readOnly:!0,defaultValue:c?c.email:""})})]}),Object(p.jsxs)(v.a,{children:[Object(p.jsx)(k.a,{children:Object(p.jsx)(x.a,{block:!0,variant:"warning",onClick:e.signOut,children:"Sign out"})}),Object(p.jsx)(k.a,{children:Object(p.jsx)(F,{block:!0,loading:e.loading,reloadCallback:i})})]})]})})})})})})}var T=function(){return Object(p.jsx)("footer",{className:"footer bg-light",children:Object(p.jsx)("div",{className:"container-fluid mx-auto mt-4",children:Object(p.jsxs)("div",{className:"row",children:[Object(p.jsxs)("div",{className:"col-12 my-auto h-100 text-center",children:[Object(p.jsx)("ul",{className:"list-inline mb-2"}),Object(p.jsxs)("p",{className:"text-muted small mb-4 mx-auto",children:["\xa9 Pagemail 2021. All Rights Reserved. Project hosted by ",Object(p.jsx)("button",{className:"btn btn-link",onClick:function(){window.open("https://pages.github.com/")},children:"GitHub Pages"}),"."]})]}),Object(p.jsx)("div",{className:"col-lg-6 my-auto h-100 text-center text-lg-right mx-auto",children:Object(p.jsx)("ul",{className:"list-inline mb-0"})})]})})})};var B=function(){var e=Object(n.useState)(!!localStorage.getItem("login_token")),t=Object(j.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),s=Object(j.a)(c,2),i=s[0],h=s[1],O=Object(n.useState)(""),v=Object(j.a)(O,2),k=v[0],w=v[1],y=Object(n.useState)(!1),N=Object(j.a)(y,2),L=N[0],F=N[1],P=Object(n.useState)(""),B=Object(j.a)(P,2),G=B[0],D=B[1],R=Object(n.useState)(""),z=Object(j.a)(R,2),U=z[0],A=z[1],V="https://api.pagemail.tech";function M(e){return new Promise((function(t){return setTimeout(t,e)}))}Object(n.useEffect)((function(){window.addEventListener("storage",(function(){localStorage.getItem("login_token")?r(!0):(r(!1),localStorage.removeItem("username"))}))}));var Y=function(){localStorage.removeItem("login_token"),r(!1),A("Signed out."),h("/")},H=Object(n.useCallback)(function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=7;break}return e.next=3,t.json();case 3:throw a=e.sent,Error(a.detail);case 7:return D(""),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[D]),J=Object(n.useCallback)(function(){var e=Object(o.a)(l.a.mark((function e(t,a,n,r){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),(c={"Content-Type":"application/x-www-form-urlencoded"}).Authorization=n?"Bearer "+localStorage.getItem("login_token"):"",e.next=5,M(1e3);case 5:return s=fetch(V+a,{method:t,redirect:"follow",headers:c,body:r}).then(H).then((function(e){return e.json()})).catch((function(e){console.log(e),D("Something went wrong: "+e.message)})),F(!1),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),[H,V]);return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(g,{loggedIn:a}),Object(p.jsxs)(b.a,{fluid:!0,className:"my-1",children:[Object(p.jsx)(m.a,{show:""!==G,variant:"warning",onClose:function(){return D("")},dismissible:!0,transition:!0,children:G}),Object(p.jsx)(m.a,{show:""!==U,variant:"success",onClose:function(){return A("")},dismissible:!0,transition:!0,children:U})]}),Object(p.jsxs)(d.a,{children:[i?Object(p.jsx)(u.a,{to:i}):null,Object(p.jsxs)(u.d,{children:[Object(p.jsx)(u.b,{path:"/login",children:a?Object(p.jsx)("p",{children:"You are already logged in."}):Object(p.jsx)(C,{loading:L,loginCall:J,redirect:h,loginStatus:r,prefillEmail:w})}),Object(p.jsx)(u.b,{path:"/signup",children:a?Object(p.jsx)("p",{children:"You are already logged in."}):Object(p.jsx)(S,{loading:L,signupCall:J,redirect:h,loginStatus:r,success:A,prefillEmail:k})}),Object(p.jsx)(u.b,{path:"/pages",children:a?Object(p.jsx)(E,{loading:L,pageCall:J}):Object(p.jsx)("p",{children:"Not logged in"})}),Object(p.jsx)(u.b,{path:"/save",children:a?Object(p.jsx)(I,{loading:L,success:A,failure:D,saveCall:J}):Object(p.jsx)("p",{children:"Not logged in"})}),Object(p.jsx)(u.b,{path:"/user",children:a?Object(p.jsx)(_,{loading:L,signOut:Y,profileCall:J}):Object(p.jsx)("p",{children:"Not logged in."})}),Object(p.jsx)(u.b,{path:"/signout",children:Object(p.jsx)(b.a,{children:Object(p.jsx)(x.a,{onClick:Y,children:"Sign out."})})}),Object(p.jsx)(u.b,{path:"/",children:Object(p.jsx)(f,{})})]})]}),Object(p.jsx)(T,{})]})},G=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,77)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(B,{})}),document.getElementById("root")),G()}},[[65,1,2]]]);
//# sourceMappingURL=main.92ba4cb1.chunk.js.map