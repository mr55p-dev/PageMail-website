(this.webpackJsonppagemail=this.webpackJsonppagemail||[]).push([[0],{52:function(e,t,a){},54:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(0),c=a.n(r),s=a(26),i=a.n(s),l=(a(52),a(10)),o=a.n(l),j=a(15),d=a(14),u=(a(54),a(45)),b=a(7),m=a(73),x=a(72);function h(e){return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)(m.a,{bg:"primary",variant:"dark",children:[Object(n.jsx)(m.a.Brand,{href:"/",children:"PageMail"}),Object(n.jsx)(m.a.Toggle,{"aria-controls":"navbar-nav"}),Object(n.jsx)(m.a.Collapse,{id:"navbar-nav mr-auto",children:Object(n.jsxs)(x.a,{className:"mr-auto",children:[Object(n.jsx)(x.a.Link,{children:"About"}),e.loggedIn?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(x.a.Link,{href:"/pages",children:"Pages"}),Object(n.jsx)(x.a.Link,{href:"/token",children:"Token"})," "]}):Object(n.jsx)(n.Fragment,{})]})}),Object(n.jsx)(x.a,{children:e.loggedIn?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(x.a.Link,{href:"/user",className:"mr-2",children:"Profile"}),Object(n.jsx)(x.a.Link,{href:"/signout",className:"mr-2",children:"Sign out"})," "]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(x.a.Link,{href:"/signup",children:"Sign up!"}),Object(n.jsx)(x.a.Link,{href:"/login",children:"Log in"})," "]})})]})})}var O=a(67),g=a(68),p=a(44),f=a(71),v=a(69),k=a(70);function w(e){var t=function(){var t=Object(j.a)(o.a.mark((function t(a){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),console.log(a),(n=new URLSearchParams).append("username",a.target.form[0].value),n.append("password",a.target.form[1].value),t.next=7,e.loginCall("POST","/user/token",!1,n);case 7:(r=t.sent)&&(localStorage.setItem("login_token",r.access_token),e.loginStatus(!0),e.redirect("/pages"));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(O.a,{fluid:!0,children:Object(n.jsx)(g.a,{children:Object(n.jsx)(p.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(n.jsx)(O.a,{color:"primary",className:"form-container bg-active",children:Object(n.jsxs)(f.a,{id:"loginForm",onSubmit:t,children:[Object(n.jsxs)(f.a.Group,{controlId:"formBasicEmail",name:"signup_email",id:"signup_email",children:[Object(n.jsx)(f.a.Label,{children:"Email address"}),Object(n.jsx)(f.a.Control,{type:"email",placeholder:"Enter email"})]}),Object(n.jsxs)(f.a.Group,{controlId:"formBasicPassword",name:"signup_password",children:[Object(n.jsx)(f.a.Label,{children:"Password"}),Object(n.jsx)(f.a.Control,{type:"password",placeholder:"Password"})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsx)(p.a,{sm:12,xl:6,children:Object(n.jsx)(v.a,{block:!0,variant:"secondary",type:"button",onClick:function(t){t.preventDefault(),e.prefillEmail(t.target.form[0].value),e.redirect("/signup")},children:"Sign Up"})}),Object(n.jsx)(p.a,{sm:12,xl:6,children:Object(n.jsx)(v.a,{block:!0,variant:"primary",type:"submit",onClick:t,disabled:e.loading,children:e.loading?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(k.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):"Log in"})})]})]})})})})})})}function y(e){var t=function(){var t=Object(j.a)(o.a.mark((function t(a){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),(n=new URLSearchParams).append("email",a.target[0].value),n.append("name",a.target[1].value),n.append("password",a.target[2].value),t.next=7,e.signupCall("POST","/user/register",!1,n);case 7:(r=t.sent)&&(localStorage.setItem("login_token",r.token.access_token),e.loginStatus(!0),e.redirect("/pages"));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(O.a,{fluid:!0,children:Object(n.jsx)(g.a,{children:Object(n.jsx)(p.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(n.jsx)(O.a,{color:"primary",className:"form-container bg-active",children:Object(n.jsxs)(f.a,{id:"signupForm",onSubmit:t,children:[Object(n.jsxs)(f.a.Group,{controlId:"formBasicEmail",name:"signup_email",id:"signup_email",children:[Object(n.jsx)(f.a.Label,{children:"Email address"}),Object(n.jsx)(f.a.Control,{type:"email",placeholder:"Enter email",defaultValue:e.prefillEmail})]}),Object(n.jsxs)(f.a.Group,{controlId:"formBasicName",name:"signup_name",children:[Object(n.jsx)(f.a.Label,{children:"Name"}),Object(n.jsx)(f.a.Control,{type:"text",placeholder:"Your name"})]}),Object(n.jsxs)(f.a.Group,{controlId:"formBasicPassword",name:"signup_password",children:[Object(n.jsx)(f.a.Label,{children:"Password"}),Object(n.jsx)(f.a.Control,{type:"password",placeholder:"Password"})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsx)(p.a,{sm:12,xl:6,children:Object(n.jsx)(v.a,{block:!0,variant:"secondary",type:"button",onClick:function(){e.redirect("/login")},children:"Log in"})}),Object(n.jsxs)(p.a,{sm:12,xl:6,children:[Object(n.jsx)(v.a,{block:!0,variant:"primary",type:"submit",disabled:e.loading,children:e.loading?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(k.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):"Sign Up"}),"                    "]})]})]})})})})})})}var C=a(75);function S(e){return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(v.a,{variant:"primary",disabled:e.loading,onClick:e.reloadCallback,children:e.loading?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(k.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," Loading"]}):e.buttonText?e.buttonText:"Reload"})})}function N(e){return Object(n.jsx)(p.a,{xl:3,md:6,xs:12,className:"my-2",children:Object(n.jsxs)(C.a,{children:[Object(n.jsxs)(C.a.Body,{children:[Object(n.jsx)(C.a.Title,{className:"text-center",children:e.title}),Object(n.jsxs)(C.a.Text,{children:["Page summary will be included here soon.",Object(n.jsxs)(g.a,{children:[Object(n.jsx)(p.a,{xl:4,sm:12,className:"mt-1",children:Object(n.jsx)(v.a,{block:!0,variant:"warning",onClick:function(){},children:"Delete"})}),Object(n.jsx)(p.a,{xl:4,sm:12,className:"mt-1",children:Object(n.jsx)(v.a,{block:!0,variant:"info",onClick:function(){},children:"Mark Read"})}),Object(n.jsx)(p.a,{xl:4,sm:12,className:"mt-1",children:Object(n.jsx)(v.a,{block:!0,variant:"primary",onClick:function(){return window.open(e.url)},children:"Open"})})]})]})]}),Object(n.jsx)(C.a.Footer,{children:Object(n.jsxs)("small",{children:["Added at ",e.date]})})]})})}function L(e){var t=Object(r.useState)([]),a=Object(d.a)(t,2),c=a[0],s=a[1],i=function(){(function(){var t=Object(j.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.pageCall("GET","/page/mypages",!0,null);case 2:a=t.sent,s(a||[]);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()};return Object(r.useEffect)((function(){i()}),[]),Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)(O.a,{fluid:!0,className:"cardDeckContainer mx-auto",children:[Object(n.jsx)(g.a,{children:c!==[]?c.map((function(e){return Object(n.jsx)(N,{title:e.page_url,url:e.page_url,date:e.date_added},e.id)})):Object(n.jsx)("p",{children:"Loading."})}),Object(n.jsx)(S,{loading:e.loading,reloadCallback:i})]})})}function E(e){var t=Object(r.useState)(null),a=Object(d.a)(t,2),c=a[0],s=a[1],i=function(){(function(){var t=Object(j.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.profileCall("GET","/user/self",!0,null);case 2:a=t.sent,s(a||null);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()};return Object(r.useEffect)((function(){i()}),[]),Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(O.a,{fluid:!0,children:Object(n.jsx)(g.a,{children:Object(n.jsx)(p.a,{xl:4,md:8,xs:12,className:"mx-auto",children:Object(n.jsx)(O.a,{color:"primary",className:"form-container bg-active",children:Object(n.jsxs)(f.a,{id:"infoForm",children:[Object(n.jsxs)(f.a.Group,{as:g.a,controlId:"formBasicEmail",name:"infoName",id:"signup_email",children:[Object(n.jsx)(f.a.Label,{column:!0,sm:2,children:"Name"}),Object(n.jsx)(p.a,{sm:10,children:Object(n.jsx)(f.a.Control,{type:"text",readOnly:!0,defaultValue:c?c.name:""})})]}),Object(n.jsxs)(f.a.Group,{as:g.a,controlId:"formBasicEmail",name:"infoEmail",id:"signup_email",children:[Object(n.jsx)(f.a.Label,{column:!0,sm:2,children:"Email address"}),Object(n.jsx)(p.a,{sm:10,children:Object(n.jsx)(f.a.Control,{type:"email",readOnly:!0,defaultValue:c?c.email:""})})]}),Object(n.jsx)(S,{loading:e.loading,reloadCallback:i})]})})})})})})}var _=function(){return Object(n.jsx)("footer",{className:"footer bg-light",children:Object(n.jsx)("div",{className:"container-fluid mx-auto mt-4",children:Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-12 my-auto h-100 text-center",children:[Object(n.jsx)("a",{href:"#"}),Object(n.jsx)("ul",{className:"list-inline mb-2"}),Object(n.jsxs)("p",{className:"text-muted small mb-4 mx-auto",children:["\xa9 Pagemail 2021. All Rights Reserved. Project hosted by ",Object(n.jsx)("button",{className:"btn btn-link",onClick:function(){window.open("https://pages.github.com/")},children:"GitHub Pages"}),"."]})]}),Object(n.jsx)("div",{className:"col-lg-6 my-auto h-100 text-center text-lg-right mx-auto",children:Object(n.jsx)("ul",{className:"list-inline mb-0"})})]})})})},F=a(74);var I=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),a=(t[0],t[1]),c=Object(r.useState)(!!localStorage.getItem("login_token")),s=Object(d.a)(c,2),i=s[0],l=s[1],m=Object(r.useState)(null),x=Object(d.a)(m,2),O=x[0],g=x[1],p=Object(r.useState)(""),f=Object(d.a)(p,2),k=f[0],C=f[1],S=Object(r.useState)(!1),N=Object(d.a)(S,2),I=N[0],P=N[1],T=Object(r.useState)(""),B=Object(d.a)(T,2),G=B[0],D=B[1],R="https://api.pagemail.tech";function A(e){return new Promise((function(t){return setTimeout(t,e)}))}function z(e){if(e.ok)return D(""),e;throw Error(e.status)}function U(e,t,a,n){return H.apply(this,arguments)}function H(){return(H=Object(j.a)(o.a.mark((function e(t,a,n,r){var c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),(c={"Content-Type":"application/x-www-form-urlencoded"}).Authorization=n?"Bearer "+localStorage.getItem("login_token"):"",e.next=5,A(1e3);case 5:return s=fetch(R+a,{method:t,redirect:"follow",headers:c,body:r}).then(z).then((function(e){return e.json()})).catch((function(e){D("Something went wrong connecting to our servers, please try again. HTTP "+e.message)})),P(!1),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){window.addEventListener("storage",(function(){localStorage.getItem("login_token")?(l(!0),a(localStorage.getItem("login_token"))):(l(!1),a(null),localStorage.removeItem("username"))}))})),Object(r.useEffect)((function(){a(localStorage.getItem("login_token"))}),[i]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(h,{loggedIn:i}),Object(n.jsx)(F.a,{show:""!==G,variant:"warning",onClose:function(){return D("")},dismissible:!0,transition:!0,children:G}),Object(n.jsxs)(u.a,{children:[O?Object(n.jsx)(b.a,{to:O}):null,Object(n.jsxs)(b.d,{children:[Object(n.jsx)(b.b,{path:"/login",children:i?Object(n.jsx)("p",{children:"You are already logged in."}):Object(n.jsx)(w,{loading:I,loginCall:U,redirect:g,loginStatus:l,prefillEmail:C})}),Object(n.jsx)(b.b,{path:"/signup",children:i?Object(n.jsx)("p",{children:"You are already logged in."}):Object(n.jsx)(y,{loading:I,signupCall:U,redirect:g,loginStatus:l,prefillEmail:k})}),Object(n.jsx)(b.b,{path:"/pages",children:i?Object(n.jsx)(L,{loading:I,pageCall:U}):Object(n.jsx)("p",{children:"Not logged in"})}),Object(n.jsx)(b.b,{path:"/user",children:i?Object(n.jsx)(E,{loading:I,profileCall:U}):Object(n.jsx)("p",{children:"Not logged in."})}),Object(n.jsxs)(b.b,{path:"/signout",children:[Object(n.jsx)("p",{children:"Click to sign out"}),Object(n.jsx)(v.a,{onClick:function(){localStorage.removeItem("login_token"),l(!1),g("/")},children:"Sign out."})]}),Object(n.jsx)(b.b,{path:"/",children:Object(n.jsx)("h1",{children:"Home"})})]})]}),Object(n.jsx)(_,{})]})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,76)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(I,{})}),document.getElementById("root")),P()}},[[65,1,2]]]);
//# sourceMappingURL=main.c1f89050.chunk.js.map